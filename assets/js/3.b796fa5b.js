(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{349:function(t,s,e){t.exports=e.p+"assets/img/shell.78ffd773.png"},350:function(t,s,e){t.exports=e.p+"assets/img/ouch.43349cfd.png"},351:function(t,s,e){t.exports=e.p+"assets/img/what-happened.292ee866.png"},352:function(t,s,e){t.exports=e.p+"assets/img/reload.7c188cb2.png"},353:function(t,s,e){t.exports=e.p+"assets/img/ouch2.41fdd812.png"},354:function(t,s,e){t.exports=e.p+"assets/img/what-happened2.860d9d1b.png"},355:function(t,s,e){t.exports=e.p+"assets/img/ouch3.2b7e7c61.png"},356:function(t,s,e){t.exports=e.p+"assets/img/fixed.6495944d.png"},357:function(t,s,e){t.exports=e.p+"assets/img/non-interactive.59857352.png"},358:function(t,s,e){t.exports=e.p+"assets/img/allure1.e9721ff3.png"},359:function(t,s,e){t.exports=e.p+"assets/img/allure2.f745cfe9.png"},373:function(t,s,e){"use strict";e.r(s);var a=e(42),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"a-quick-prescript-primer-tutorial"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#a-quick-prescript-primer-tutorial"}},[t._v("#")]),t._v(" A quick prescript primer (Tutorial)")]),t._v(" "),a("p",[t._v("Ready for a "),a("strong",[t._v("prescript")]),t._v("ed experience? You‚Äôll need:")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://nodejs.org/en/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Node.js"),a("OutboundLink")],1),t._v(" (at least version 8)")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://yarnpkg.com/en/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Yarn"),a("OutboundLink")],1),t._v(" (make sure you have the latest version!)")])]),t._v(" "),a("p",[t._v("I assume you know how to use Node.js and Yarn.")]),t._v(" "),a("p",[t._v("In this tutorial, we‚Äôll learn:")]),t._v(" "),a("ol",[a("li",[t._v("How to create a test file.")]),t._v(" "),a("li",[t._v("How to use the "),a("strong",[t._v("prescript interactive shell")]),t._v(" to debug and fix a test file.")]),t._v(" "),a("li",[t._v("How to run the test and generate a report.")])]),t._v(" "),a("p",[t._v("We‚Äôre going to write a simple test using "),a("strong",[t._v("prescript")]),t._v(" and\n"),a("a",{attrs:{href:"https://github.com/googlechrome/puppeteer/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Puppeteer"),a("OutboundLink")],1),t._v(". It will go to\n"),a("code",[t._v("npmjs.com")]),t._v(", search for "),a("code",[t._v("prescript")]),t._v(", and verify that prescript is actually on\nnpm.")]),t._v(" "),a("h2",{attrs:{id:"test-project-setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#test-project-setup"}},[t._v("#")]),t._v(" Test project setup")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Let‚Äôs start by creating a new project:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" prescript-tutorial\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" prescript-tutorial\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Install "),a("code",[t._v("prescript")]),t._v(" and "),a("code",[t._v("puppeteer")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" --dev prescript puppeteer\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Create a folder to store all our tests:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" tests\n")])])])])]),t._v(" "),a("p",[t._v("Now, our directory structure should look like this:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("prescript-tutorial\n‚îú‚îÄ‚îÄ tests/\n‚îú‚îÄ‚îÄ package.json\n‚îî‚îÄ‚îÄ yarn.lock\n")])])]),a("h2",{attrs:{id:"create-the-test-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-the-test-file"}},[t._v("#")]),t._v(" Create the test file")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Create a file called "),a("code",[t._v("tests/npm-search.js")]),t._v(" and paste in:")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" puppeteer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'puppeteer'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" action"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" defer "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'prescript'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" assert "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'assert'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'A quest for \"prescript\" on npm'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("action")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Open a web browser'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("browser "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" puppeteer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("launch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" headless"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("browser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("newPage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Close browser'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("browser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("action")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Go to npmjs.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("goto")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://npmjs.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("action")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Search for prescript'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[name=\"q\"]'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'prescript'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("action")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Verify that the description is correct'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" description "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getText")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[class^=\"package-list-item__description\"]'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    assert"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("equal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("description"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'an end-to-end test runner that sparks joy'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getText")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" selector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("evaluate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("selector")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("selector"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    selector\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])]),t._v(" "),a("ul",[a("li",[t._v("The "),a("code",[t._v("test()")]),t._v(" function declares a "),a("strong",[t._v("test")]),t._v(". A test can contain multiple\n"),a("strong",[t._v("steps")]),t._v(".")]),t._v(" "),a("li",[t._v("The "),a("code",[t._v("action()")]),t._v(" function declares an "),a("strong",[t._v("action step")]),t._v(", which represents a test\naction to be executed.")]),t._v(" "),a("li",[t._v("The "),a("code",[t._v("defer()")]),t._v(" function declares a "),a("strong",[t._v("deferred step")]),t._v(", which represents an\naction to be performed at the end of the test (similar to\n"),a("a",{attrs:{href:"https://tour.golang.org/flowcontrol/12",target:"_blank",rel:"noopener noreferrer"}},[t._v("Go‚Äôs defer statement"),a("OutboundLink")],1),t._v("), and is useful\nfor cleaning up and closing resources.")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("THE `state` VARIABLE")]),t._v(" "),a("p",[t._v("You may notice there‚Äôs a variable called "),a("code",[t._v("state")]),t._v(". You must put everything that‚Äôs\nshared between steps in this variable.")]),t._v(" "),a("p",[a("strong",[t._v("Do not create variables to hold the state of your tests.")]),t._v(" You may ask, ‚Äúwhy\ncan‚Äôt we just use local variables, i.e. putting "),a("code",[t._v("let browser")]),t._v(" at the top of the\nfile?‚Äù Well, you‚Äôll see why soon‚Ä¶ üòâ")])]),t._v(" "),a("h2",{attrs:{id:"run-the-test-in-development-mode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#run-the-test-in-development-mode"}},[t._v("#")]),t._v(" Run the test in development mode")]),t._v(" "),a("p",[t._v("Now we have the test, let‚Äôs run it!")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Run the test in "),a("strong",[t._v("development mode")]),t._v(" using "),a("code",[t._v("yarn prescript -d <test-file>")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" prescript -d tests/npm-search.js\n")])])])])]),t._v(" "),a("p",[t._v("This will drop you into a "),a("strong",[t._v("prescript interactive shell:")])]),t._v(" "),a("p",[a("img",{attrs:{src:e(349),alt:"Screenshot"}})]),t._v(" "),a("ul",[a("li",[t._v("Type in "),a("strong",[a("code",[t._v("continue")])]),t._v(" and press Enter.")])]),t._v(" "),a("p",[t._v("This will run the test to its completion (or until it hits an error).")]),t._v(" "),a("p",[t._v("Let‚Äôs see how it goes‚Ä¶")]),t._v(" "),a("p",[a("img",{attrs:{src:e(350),alt:"Screenshot"}})]),t._v(" "),a("p",[t._v("Oops, there‚Äôs an error!")]),t._v(" "),a("p",[t._v("From the terminal output, we see that "),a("strong",[t._v("the test failed at step 5")]),t._v(" (‚ÄòVerify\nthat the description is correct‚Äô)‚Ä¶ This is one benefit of breaking your test\ninto discrete steps ‚Äî the tool can tell you exactly which step failed.")]),t._v(" "),a("p",[t._v("It‚Äôs time to debug!")]),t._v(" "),a("h2",{attrs:{id:"debugging-the-test"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#debugging-the-test"}},[t._v("#")]),t._v(" Debugging the test")]),t._v(" "),a("p",[t._v("Now, since we are in "),a("strong",[t._v("interactive development mode")]),t._v(", the test is "),a("strong",[t._v("paused")]),t._v("\nhere to let you inspect what‚Äôs going on. (In many other tools, the browser would\nhave closed immediately.)")]),t._v(" "),a("p",[t._v("Now we can take a look at the browser:")]),t._v(" "),a("p",[a("img",{attrs:{src:e(351),alt:"Screenshot"}})]),t._v(" "),a("p",[t._v("Hm‚Ä¶ ü§î what‚Äôs going on here???‚Ä¶‚Ä¶‚Ä¶‚Ä¶Oh! üò≤ There it is! üí°")]),t._v(" "),a("p",[t._v("We found that in "),a("strong",[t._v("step 4 (‚ÄòSearch for prescript‚Äô), we typed the search text but\ndidn‚Äôt press Enter.")]),t._v(" That‚Äôs why we stay at the same page...")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("div",{staticClass:"highlighted"},[t._v("¬†")]),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("action")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Search for prescript'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[name=\"q\"]'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'prescript'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),t._v(" "),a("p",[t._v("So, we can say that "),a("strong",[t._v("the fault in step 4 caused the failure in step 5.")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("FAULT vs FAILURE")]),t._v(" "),a("p",[a("strong",[t._v("prescript")]),t._v(" tells you which step caused the test to fail. But the "),a("strong",[t._v("failure")]),t._v("\nmay be caused by a "),a("strong",[t._v("fault")]),t._v(" in a prior step.")])]),t._v(" "),a("h2",{attrs:{id:"fixing-the-test"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fixing-the-test"}},[t._v("#")]),t._v(" Fixing the test")]),t._v(" "),a("p",[t._v("Let‚Äôs go ahead and fix it‚Ä¶")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Update the test so that we press Enter key after typing in ‚Äúprescript‚Äù:")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v("¬†")]),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("action")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Search for prescript'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[name=\"q\"]'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'prescript'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("keyboard"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("press")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Enter'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Don‚Äôt forget to save the file.")])])]),t._v(" "),a("h2",{attrs:{id:"hot-reloading-the-test"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hot-reloading-the-test"}},[t._v("#")]),t._v(" Hot-reloading the test")]),t._v(" "),a("p",[t._v("Now we‚Äôre going to hot-reload our test file.")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Come back to "),a("strong",[t._v("prescript interactive shell")]),t._v(".")])]),t._v(" "),a("li",[a("p",[t._v("Type in "),a("strong",[a("code",[t._v("reload")])]),t._v(" (or "),a("code",[t._v("r")]),t._v(") and press Enter.")])])]),t._v(" "),a("p",[t._v("The test plan will be reloaded, but all your test state will remain intact.")]),t._v(" "),a("p",[a("img",{attrs:{src:e(352),alt:"Screenshot"}})]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),a("p",[t._v("That‚Äôs why we need to use prescript-provided "),a("code",[t._v("state")]),t._v(" object ‚Äî its contents are\npreserved across reloads! Had we used local variables (i.e. using\n"),a("code",[t._v("let browser, page")]),t._v(" instead of "),a("code",[t._v("state.browser")]),t._v(" and "),a("code",[t._v("state.page")]),t._v("), our\nnewly-loaded test code wouldn‚Äôt be able to access the "),a("code",[t._v("browser")]),t._v(" and "),a("code",[t._v("page")]),t._v("\ncreated in the previously-loaded test code, because it‚Äôs ‚Äî well ‚Äî local to it.\nThat‚Äôs how hot-reloading is made possible in prescript.")])]),t._v(" "),a("h2",{attrs:{id:"resuming-the-test"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#resuming-the-test"}},[t._v("#")]),t._v(" Resuming the test")]),t._v(" "),a("p",[t._v("When you "),a("strong",[a("code",[t._v("reload")])]),t._v(" your test, prescript will put you before the failed step.")]),t._v(" "),a("p",[t._v("But as aforementioned, the fault in "),a("strong",[t._v("step 4")]),t._v(" caused the failure in "),a("strong",[t._v("step 5")]),t._v(".\nThat means to recover, we must go back to "),a("strong",[t._v("step 4")]),t._v(" and continue from there.")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Jump to step 4 by typing "),a("strong",[a("code",[t._v("jump 4")])]),t._v(" (or "),a("code",[t._v("j 4")]),t._v(") and press Enter.")])]),t._v(" "),a("li",[a("p",[t._v("Continue running the test by typing "),a("strong",[a("code",[t._v("continue")])]),t._v(" (or "),a("code",[t._v("c")]),t._v(") and press Enter.")])])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),a("p",[t._v("That‚Äôs why you need to break down your test into discrete steps ‚Äî this allows\nprescript to take control of the way your test code is executed, thus letting\nyou jump around and resume execution in the middle of your test.")])]),t._v(" "),a("p",[t._v("Let‚Äôs see how it goes‚Ä¶")]),t._v(" "),a("p",[a("img",{attrs:{src:e(353),alt:"Screenshot"}})]),t._v(" "),a("p",[t._v("Waaaa‚Äî!")]),t._v(" "),a("p",[t._v("It failed again!")]),t._v(" "),a("p",[t._v("Let‚Äôs look at the browser to see what happened...")]),t._v(" "),a("p",[a("img",{attrs:{src:e(354),alt:"Screenshot"}})]),t._v(" "),a("p",[t._v("This time, the search box contains the text ‚Äòprescriptprescript‚Äô. Since we\n"),a("strong",[t._v("retried")]),t._v(" step 4, it got executed twice. That means the word ‚Äòprescript‚Äô got\ntyped into the search box twice!")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("LESSON")]),t._v(" "),a("p",[t._v("When reloading or jumping, make sure to roll the state back before continuing!")])]),t._v(" "),a("h2",{attrs:{id:"rolling-the-state-back"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rolling-the-state-back"}},[t._v("#")]),t._v(" Rolling the state back")]),t._v(" "),a("p",[t._v("Ok, let‚Äôs try again.")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Jump back to step 4 by typing "),a("strong",[a("code",[t._v("jump 4")])]),t._v(" (or "),a("code",[t._v("j 4")]),t._v(") and press Enter.")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("In the browser, manually delete the text in the search box.")]),t._v(" Also click the\nBack button so that we are back to npm‚Äôs homepage. "),a("strong",[t._v("This effectively brings\nus to the known state before step 4 is first executed.")])])]),t._v(" "),a("li",[a("p",[t._v("Continue running the test by typing "),a("strong",[a("code",[t._v("continue")])]),t._v(" (or "),a("code",[t._v("c")]),t._v(") and press Enter.")])])]),t._v(" "),a("p",[a("img",{attrs:{src:e(355),alt:"Screenshot"}})]),t._v(" "),a("p",[t._v("Ouch‚Ä¶ It failed again, at "),a("strong",[t._v("step 5")]),t._v(" (‚ÄòVerify that the description is correct‚Äô)!")]),t._v(" "),a("p",[t._v("But this time, it seems that the browser is showing the correct result.")]),t._v(" "),a("p",[t._v("This is because "),a("strong",[t._v("step 4 finished immediately after we press Enter.")]),t._v(" It didn‚Äôt\nwait for the search results to load or anything; it just hit Enter and moved on\nto "),a("strong",[t._v("step 5")]),t._v(" right away. So, "),a("strong",[t._v("step 5")]),t._v(" tried to verify the search result\nimmediately, when it‚Äôs not available yet. Of course, this would fail the test.")]),t._v(" "),a("h2",{attrs:{id:"fault-containment"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fault-containment"}},[t._v("#")]),t._v(" Fault containment")]),t._v(" "),a("p",[t._v("As you can see, a "),a("strong",[t._v("fault")]),t._v(" in one step can cause a "),a("strong",[t._v("failure")]),t._v(" in subsequent\nsteps. This can lead to tests that are hard to debug. To write tests that can be\neasily debugged, it‚Äôs important to follow the "),a("strong",[t._v("fault containment principle‚Ä¶")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("FAULT CONTAINMENT PRINCIPLE")]),t._v(" "),a("p",[t._v("Make sure each step verifies the outcome of its own action.")]),t._v(" "),a("p",[t._v("For example,")]),t._v(" "),a("ul",[a("li",[t._v("Step 1 (‚ÄòGo to npmjs.com‚Äô) should wait for the web page to load, and verify\nthat "),a("code",[t._v("npmjs.com")]),t._v("‚Äôs home page is indeed displayed (instead of e.g. 502 pages).")]),t._v(" "),a("li",[t._v("Step 2 (‚ÄòSearch for prescript‚Äô) should wait for the search results to load,\nand verify that the search results are available before moving on.")])])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Update the test so that each step waits and checks for the outcome of its own\nactions (Don‚Äôt forget to save the file!):")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v("¬†")]),a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v("¬†")]),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("action")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Go to npmjs.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("goto")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://npmjs.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("waitForSelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#app main'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("action")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Search for prescript'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[name=\"q\"]'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'prescript'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("keyboard"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("press")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Enter'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("waitForSelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[class^=\"search__packageList\"]'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),a("h2",{attrs:{id:"seeing-the-test-pass"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#seeing-the-test-pass"}},[t._v("#")]),t._v(" Seeing the test pass")]),t._v(" "),a("p",[t._v("Hopefully, we‚Äôve fixed everything now.")]),t._v(" "),a("ul",[a("li",[t._v("In "),a("strong",[t._v("prescript interactive shell")]),t._v(", "),a("strong",[a("code",[t._v("reload")])]),t._v(", "),a("strong",[a("code",[t._v("jump 4")])]),t._v(", and "),a("strong",[a("code",[t._v("continue")])]),t._v(".")])]),t._v(" "),a("p",[t._v("Now, our test should pass üòâ")]),t._v(" "),a("p",[a("img",{attrs:{src:e(356),alt:"Screenshot"}})]),t._v(" "),a("ul",[a("li",[t._v("Exit prescript by typing "),a("strong",[a("code",[t._v("exit")])]),t._v(" and press Enter.")])]),t._v(" "),a("p",[t._v("Now you can see how having an "),a("strong",[t._v("interactive development mode")]),t._v(" can help you\ndebug a failed test with tighter feedback loop.")]),t._v(" "),a("h2",{attrs:{id:"running-the-test-in-non-interactive-mode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#running-the-test-in-non-interactive-mode"}},[t._v("#")]),t._v(" Running the test in non-interactive mode")]),t._v(" "),a("p",[t._v("Having an "),a("strong",[t._v("interactive development mode")]),t._v(" at hand is great, but we also want to\nrun our tests as part of a continuous integration build process. That‚Äôs where we\nshould run the test in non-interactive mode.")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Run the test in "),a("strong",[t._v("non-interactive mode")]),t._v(" using "),a("code",[t._v("yarn prescript <test-file>")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" prescript tests/npm-search.js\n")])])])])]),t._v(" "),a("p",[t._v("This will run the test to its completion, or exits with an error code if the\ntest failed. The prescript interactive shell is not available in this mode.")]),t._v(" "),a("p",[a("img",{attrs:{src:e(357),alt:"Screenshot"}})]),t._v(" "),a("h2",{attrs:{id:"generating-allure-test-reports"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#generating-allure-test-reports"}},[t._v("#")]),t._v(" Generating Allure test reports")]),t._v(" "),a("p",[t._v("As introduced in the previous page, prescript can generate a beautiful test\nreport using Allure.")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Install the "),a("strong",[t._v("Allure")]),t._v(" command-line tool by following the\n"),a("a",{attrs:{href:"https://docs.qameta.io/allure/#_installing_a_commandline",target:"_blank",rel:"noopener noreferrer"}},[t._v("installation steps in its docs"),a("OutboundLink")],1),t._v(".")])]),t._v(" "),a("li",[a("p",[t._v("Set the environment variable "),a("code",[t._v("ALLURE_TEST_RESULTS")]),t._v(" for the current shell:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Linux, macOS")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ALLURE_RESULTS_DIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("allure-results\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Windows")]),t._v("\nSET "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ALLURE_RESULTS_DIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("allure-results\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Run the test in "),a("strong",[t._v("non-interactive mode")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("yarn")]),t._v(" prescript tests/npm-search.js\n")])])])])]),t._v(" "),a("p",[t._v("You should see a directory called "),a("strong",[t._v("allure-results")]),t._v(" created. Inside it, you\nshould see XML files.")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),a("p",[t._v("If you use Git, don‚Äôt forget to add "),a("code",[t._v("allure-results")]),t._v(" to your "),a("code",[t._v(".gitignore")]),t._v(".")])]),t._v(" "),a("h3",{attrs:{id:"view-the-test-report"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#view-the-test-report"}},[t._v("#")]),t._v(" View the test report")]),t._v(" "),a("p",[t._v("As you can see, "),a("strong",[t._v("prescript")]),t._v(" generates XML files to be used by Allure to\ngenerate a test report.")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("To view the test report:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("allure serve allure-results\n")])])])])]),t._v(" "),a("p",[a("img",{attrs:{src:e(358),alt:"Screenshot"}})]),t._v(" "),a("p",[a("img",{attrs:{src:e(359),alt:"Screenshot"}})]),t._v(" "),a("p",[t._v("Nice.")]),t._v(" "),a("h3",{attrs:{id:"generate-the-test-report"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#generate-the-test-report"}},[t._v("#")]),t._v(" Generate the test report")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("allure serve")]),t._v(" command lets you view the report in the browser. But you may\nwant to generate the test report and upload them for others to see.")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("To generate the test report:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("allure generate test-results\n")])])])])]),t._v(" "),a("p",[t._v("A directory "),a("code",[t._v("allure-report")]),t._v(" should pop up in your project directory. You can\nthen publish your generated "),a("code",[t._v("allure-report")]),t._v(" and share with your colleague.")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),a("p",[t._v("If you use Git, don‚Äôt forget to add "),a("code",[t._v("allure-report")]),t._v(" to your "),a("code",[t._v(".gitignore")]),t._v(".")])]),t._v(" "),a("h2",{attrs:{id:"conclusion"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[t._v("#")]),t._v(" Conclusion")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("We learned how to write test in prescript using the "),a("code",[t._v("test")]),t._v(", "),a("code",[t._v("action")]),t._v(", and\n"),a("code",[t._v("defer")]),t._v(" APIs.")])]),t._v(" "),a("li",[a("p",[t._v("We learned how to use the "),a("strong",[t._v("prescript interactive shell")]),t._v(" to debug a test.")])]),t._v(" "),a("li",[a("p",[t._v("We learned how to run tests in "),a("strong",[t._v("interactive development mode")]),t._v(" and\n"),a("strong",[t._v("non-interactive mode")]),t._v(".")])]),t._v(" "),a("li",[a("p",[t._v("We learned how to generate an "),a("strong",[t._v("test report")]),t._v(" using Allure.")])])]),t._v(" "),a("p",[t._v("The next section will dive into more details about writing tests in prescript.\nThere, you will learn how to, for example, define "),a("strong",[t._v("nested steps")]),t._v(", or use a\npage object pattern for a "),a("strong",[t._v("cleaner test code.")])])])}),[],!1,null,null,null);s.default=n.exports}}]);