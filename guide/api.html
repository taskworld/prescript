<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API | prescript</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="an end-to-end test runner that sparks joy">
    <link rel="preload" href="/assets/css/0.styles.aa6d0e5c.css" as="style"><link rel="preload" href="/assets/js/app.9890758b.js" as="script"><link rel="preload" href="/assets/js/2.88f39d50.js" as="script"><link rel="preload" href="/assets/js/11.175271cf.js" as="script"><link rel="prefetch" href="/assets/js/10.515d8d3c.js"><link rel="prefetch" href="/assets/js/12.817b8d38.js"><link rel="prefetch" href="/assets/js/13.2b031eb4.js"><link rel="prefetch" href="/assets/js/14.8b3e2010.js"><link rel="prefetch" href="/assets/js/3.854d05ae.js"><link rel="prefetch" href="/assets/js/4.7f3adafd.js"><link rel="prefetch" href="/assets/js/5.e6ef8d81.js"><link rel="prefetch" href="/assets/js/6.4951d5b1.js"><link rel="prefetch" href="/assets/js/7.9cdea821.js"><link rel="prefetch" href="/assets/js/8.89f5674c.js"><link rel="prefetch" href="/assets/js/9.0b415673.js">
    <link rel="stylesheet" href="/assets/css/0.styles.aa6d0e5c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">prescript</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="https://github.com/taskworld/prescript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="https://github.com/taskworld/prescript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>User guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/" class="sidebar-link">Introduction</a></li><li><a href="/guide/tutorial.html" class="sidebar-link">A quick prescript primer (Tutorial)</a></li><li><a href="/guide/writing-tests.html" class="sidebar-link">Writing tests in prescript</a></li><li><a href="/guide/cli.html" class="sidebar-link">Running a test (CLI)</a></li><li><a href="/guide/api.html" class="active sidebar-link">API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/api.html#test" class="sidebar-link">test</a></li><li class="sidebar-sub-header"><a href="/guide/api.html#to" class="sidebar-link">to</a></li><li class="sidebar-sub-header"><a href="/guide/api.html#action-name-async-state-context" class="sidebar-link">action(name, async (state, context) =&gt; { ... })</a></li><li class="sidebar-sub-header"><a href="/guide/api.html#defer" class="sidebar-link">defer</a></li><li class="sidebar-sub-header"><a href="/guide/api.html#pending" class="sidebar-link">pending()</a></li><li class="sidebar-sub-header"><a href="/guide/api.html#getcurrentstate" class="sidebar-link">getCurrentState()</a></li><li class="sidebar-sub-header"><a href="/guide/api.html#getcurrentcontext" class="sidebar-link">getCurrentContext()</a></li><li class="sidebar-sub-header"><a href="/guide/api.html#independent" class="sidebar-link">independent(() =&gt; { ... })</a></li></ul></li><li><a href="/guide/config.html" class="sidebar-link">Advanced configuration</a></li><li><a href="/guide/tips.html" class="sidebar-link">Tips for writing tests</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>More topics</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/typings.html" class="sidebar-link">VS Code JavaScript IntelliSense and/or TypeScript Support</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="api"><a href="#api" class="header-anchor">#</a> API</h1> <p>Import <code>prescript</code> to access its APIs.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> test<span class="token punctuation">,</span> to<span class="token punctuation">,</span> action<span class="token punctuation">,</span> defer<span class="token punctuation">,</span> pending<span class="token punctuation">,</span> independent <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'prescript'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="test"><a href="#test" class="header-anchor">#</a> <code>test</code></h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'Test name'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* Define steps here */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
test<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Test name</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* Define steps here */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div> <p>Creates a <strong>test.</strong></p> <h2 id="to"><a href="#to" class="header-anchor">#</a> <code>to</code></h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">to</span><span class="token punctuation">(</span><span class="token string">'Log in'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* Define sub-steps here */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
to<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Log in</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* Define sub-steps here */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div> <p>Creates a <strong>composite step.</strong></p> <h2 id="action-name-async-state-context"><a href="#action-name-async-state-context" class="header-anchor">#</a> <code>action(name, async (state, context) =&gt; { ... })</code></h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">action</span><span class="token punctuation">(</span><span class="token string">'Fill in username'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* Action here */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
action<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Fill in username</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* Action here */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div> <p>Creates an <strong>action step.</strong> The function passed to <code>action()</code> will be called
with these arguments:</p> <ul><li><strong>state</strong> - The state object. In the beginning of the test, it is empty. Add
things to this object to share state between steps and have it persisted
between reloads.</li> <li><strong>context</strong> - The context object contains:
<ul><li><code>log(...)</code> - Logs a message to the console. Use this instead of
<code>console.log()</code> so that it doesn’t mess up console output.</li> <li><code>attach(name, buffer, mimeType)</code> — Attachs some binary output. For example,
screenshots, raw API response. This will get written to the Allure report.</li></ul></li></ul> <h2 id="defer"><a href="#defer" class="header-anchor">#</a> <code>defer</code></h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">defer</span><span class="token punctuation">(</span><span class="token string">'Close browser'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* Action here */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
defer<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Close browser</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">/* Action here */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div> <p>Creates a <strong>deferred step</strong> which queues an action to be run at the end of test.
If the test reached this step, the action will be queued for running at the end,
regardless of whether the test passed or not.</p> <p>A common pattern is to create a deferred step for closing the resource right
after the action step that requested the resource.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">action</span><span class="token punctuation">(</span><span class="token string">'Open browser'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span> desiredCapabilities<span class="token operator">:</span> <span class="token punctuation">{</span> browserName<span class="token operator">:</span> <span class="token string">'chrome'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
  <span class="token keyword">const</span> browser <span class="token operator">=</span> webdriverio<span class="token punctuation">.</span><span class="token function">remote</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
  state<span class="token punctuation">.</span>browser <span class="token operator">=</span> browser
  <span class="token keyword">await</span> browser<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">defer</span><span class="token punctuation">(</span><span class="token string">'Quit browser'</span><span class="token punctuation">,</span> <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> state<span class="token punctuation">.</span>browser<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="pending"><a href="#pending" class="header-anchor">#</a> <code>pending()</code></h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">pending</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div> <p>Defines a <strong>pending step.</strong> When a pending step is run, it marks the test as
pending.</p> <ul><li>When running in <strong>development mode</strong>, this causes the test to <strong>pause</strong>.</li> <li>When run in <strong>non-interactive mode</strong>, prescript will <strong>exit with code 2</strong>.</li></ul> <p>See more example how to use a pending step
<a href="https://prescript.netlify.com/guide/writing-tests.html#pending-steps" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h2 id="getcurrentstate"><a href="#getcurrentstate" class="header-anchor">#</a> <code>getCurrentState()</code></h2> <p>Returns the current test state object. This method allows library functions to
access the current state without requiring user to pass the <code>state</code> object all
the way from the action.</p> <p>This can make writing tests more convenient, but treat this like a global
variable — it introduces an <em>implicit</em> runtime dependency from the caller to
prescript’s internal state.</p> <h2 id="getcurrentcontext"><a href="#getcurrentcontext" class="header-anchor">#</a> <code>getCurrentContext()</code></h2> <p>Returns the current test state object. This method allows library functions to
access functions such as <code>context.log()</code> and <code>context.attachment()</code> without
requiring users to pass the <code>state</code> object all the way from the action.</p> <p>This can make writing tests more convenient, but treat this like a global
variable — it introduces an <em>implicit</em> runtime dependency from the caller to
prescript’s internal state.</p> <h2 id="independent"><a href="#independent" class="header-anchor">#</a> <code>independent(() =&gt; { ... })</code></h2> <p>Steps directly inside this block will be run independently. For example, in the
following code, actions A, B, and C would always be run even if preceding
actions failed. However, action D will not be run if any previous actions
failed.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">independent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  action<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">A</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
  action<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">B</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
  action<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">C</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
action<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">D</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/cli.html" class="prev">
        Running a test (CLI)
      </a></span> <span class="next"><a href="/guide/config.html">
        Advanced configuration
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.9890758b.js" defer></script><script src="/assets/js/2.88f39d50.js" defer></script><script src="/assets/js/11.175271cf.js" defer></script>
  </body>
</html>
